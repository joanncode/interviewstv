<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Video Platform Integration</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="web/public/css/dark-theme.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <h2 class="text-center mb-4">Test Video Platform Integration</h2>
                
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Interview Type Selection</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="type" class="form-label">Interview Type *</label>
                            <select class="form-select" id="type" name="type" required>
                                <option value="">Select type</option>
                                <option value="video">Video Interview</option>
                                <option value="audio">Audio Interview</option>
                                <option value="text">Text Interview</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Video Platform Links Section -->
                <div id="video-platform-section" class="mb-4" style="display: none;">
                    <label class="form-label">
                        <i class="fab fa-youtube text-danger me-2"></i>Video Platform Links
                    </label>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        Add links to existing videos from popular streaming platforms
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="youtube_url" class="form-label">
                                    <i class="fab fa-youtube text-danger me-1"></i>YouTube URL
                                </label>
                                <input type="url" 
                                       class="form-control" 
                                       id="youtube_url" 
                                       name="youtube_url"
                                       placeholder="https://www.youtube.com/watch?v=...">
                                <div class="form-text">Paste a YouTube video URL</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="vimeo_url" class="form-label">
                                    <i class="fab fa-vimeo text-primary me-1"></i>Vimeo URL
                                </label>
                                <input type="url" 
                                       class="form-control" 
                                       id="vimeo_url" 
                                       name="vimeo_url"
                                       placeholder="https://vimeo.com/...">
                                <div class="form-text">Paste a Vimeo video URL</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="twitch_url" class="form-label">
                                    <i class="fab fa-twitch text-purple me-1"></i>Twitch URL
                                </label>
                                <input type="url" 
                                       class="form-control" 
                                       id="twitch_url" 
                                       name="twitch_url"
                                       placeholder="https://www.twitch.tv/videos/...">
                                <div class="form-text">Paste a Twitch video URL</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="dailymotion_url" class="form-label">
                                    <i class="fas fa-video text-info me-1"></i>Dailymotion URL
                                </label>
                                <input type="url" 
                                       class="form-control" 
                                       id="dailymotion_url" 
                                       name="dailymotion_url"
                                       placeholder="https://www.dailymotion.com/video/...">
                                <div class="form-text">Paste a Dailymotion video URL</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="other_video_url" class="form-label">
                            <i class="fas fa-link me-1"></i>Other Video Platform URL
                        </label>
                        <input type="url" 
                               class="form-control" 
                               id="other_video_url" 
                               name="other_video_url"
                               placeholder="https://...">
                        <div class="form-text">Any other video platform URL (TikTok, Instagram, Facebook, etc.)</div>
                    </div>
                    
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>Note:</strong> Make sure the video is publicly accessible and allows embedding. 
                        Some platforms may have restrictions on external embedding.
                    </div>
                </div>

                <div class="card">
                    <div class="card-body">
                        <button type="button" class="btn btn-primary" onclick="testFormData()">
                            <i class="fas fa-test-tube me-2"></i>Test Form Data Collection
                        </button>
                        <div id="test-results" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Toggle video section when interview type changes
        document.getElementById('type').addEventListener('change', function() {
            const videoPlatformSection = document.getElementById('video-platform-section');
            if (this.value === 'video') {
                videoPlatformSection.style.display = 'block';
            } else {
                videoPlatformSection.style.display = 'none';
            }
        });

        // URL validation patterns
        const urlPatterns = {
            youtube_url: /^https?:\/\/(www\.)?(youtube\.com\/watch\?v=|youtu\.be\/)/,
            vimeo_url: /^https?:\/\/(www\.)?vimeo\.com\/\d+/,
            twitch_url: /^https?:\/\/(www\.)?twitch\.tv\/(videos\/\d+|[a-zA-Z0-9_]+)/,
            dailymotion_url: /^https?:\/\/(www\.)?dailymotion\.com\/video\/[a-zA-Z0-9]+/,
            other_video_url: /^https?:\/\/.+/ // Basic URL validation for other platforms
        };

        // Validate video URL
        function validateVideoUrl(input) {
            const url = input.value.trim();
            if (!url) {
                clearFieldError(input);
                return true; // Empty is valid (optional field)
            }

            const pattern = urlPatterns[input.id];
            if (pattern && !pattern.test(url)) {
                let platformName = input.id.replace('_url', '').replace('_', ' ');
                platformName = platformName.charAt(0).toUpperCase() + platformName.slice(1);

                showFieldError(input.id, `Please enter a valid ${platformName} URL`);
                return false;
            }

            clearFieldError(input);
            return true;
        }

        function showFieldError(fieldId, message) {
            const field = document.getElementById(fieldId);
            if (!field) return;

            // Remove existing error
            clearFieldError(field);

            // Add error styling
            field.classList.add('is-invalid');

            // Create error message
            const errorDiv = document.createElement('div');
            errorDiv.className = 'invalid-feedback';
            errorDiv.textContent = message;
            errorDiv.id = `${fieldId}_error`;

            // Insert error message after the field
            field.parentNode.insertBefore(errorDiv, field.nextSibling);
        }

        function clearFieldError(input) {
            if (typeof input === 'string') {
                input = document.getElementById(input);
            }
            if (!input) return;

            input.classList.remove('is-invalid');
            const errorElement = document.getElementById(`${input.id}_error`);
            if (errorElement) {
                errorElement.remove();
            }
        }

        // Add validation to all video URL inputs
        document.addEventListener('DOMContentLoaded', function() {
            const videoUrlInputs = ['youtube_url', 'vimeo_url', 'twitch_url', 'dailymotion_url', 'other_video_url'];
            videoUrlInputs.forEach(inputId => {
                const input = document.getElementById(inputId);
                if (input) {
                    input.addEventListener('change', function() {
                        validateVideoUrl(this);
                    });
                }
            });
        });

        // Test form data collection
        function testFormData() {
            const formData = {
                type: document.getElementById('type').value,
                video_platforms: {}
            };

            if (formData.type === 'video') {
                const videoUrlInputs = ['youtube_url', 'vimeo_url', 'twitch_url', 'dailymotion_url', 'other_video_url'];

                videoUrlInputs.forEach(inputId => {
                    const input = document.getElementById(inputId);
                    if (input && input.value.trim()) {
                        const platformName = inputId.replace('_url', '');
                        formData.video_platforms[platformName] = input.value.trim();
                    }
                });
            }

            document.getElementById('test-results').innerHTML = `
                <div class="alert alert-success">
                    <h6>Form Data Collected:</h6>
                    <pre>${JSON.stringify(formData, null, 2)}</pre>
                    <hr>
                    <h6>Upload Media Required:</h6>
                    <p class="mb-0">${Object.keys(formData.video_platforms).length > 0 ? 'No - Video platform links provided' : 'Yes - No video platform links provided'}</p>
                </div>
            `;
        }
    </script>
</body>
</html>
