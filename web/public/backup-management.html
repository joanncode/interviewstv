<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backup Management - Interviews.tv</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="css/dark-theme.css" rel="stylesheet">
    <style>
        .backup-card {
            background: #2a2a2a;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #444;
            transition: all 0.3s ease;
        }

        .backup-card:hover {
            border-color: #FF0000;
            transform: translateY(-2px);
        }

        .backup-item {
            background: #333;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid #444;
            transition: all 0.3s ease;
        }

        .backup-item:hover {
            border-color: #FF0000;
            background: #3a3a3a;
        }

        .backup-status {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .backup-status.completed { background: #28a745; color: white; }
        .backup-status.failed { background: #dc3545; color: white; }
        .backup-status.running { background: #ffc107; color: black; }
        .backup-status.pending { background: #6c757d; color: white; }

        .backup-size {
            color: #888;
            font-size: 0.9rem;
        }

        .backup-date {
            color: #ccc;
            font-size: 0.9rem;
        }

        .system-status {
            background: #333;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 0.5rem;
        }

        .status-indicator.healthy { background: #28a745; }
        .status-indicator.warning { background: #ffc107; }
        .status-indicator.error { background: #dc3545; }

        .metric-card {
            background: #333;
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
            border: 1px solid #444;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #FF0000;
        }

        .metric-label {
            color: #ccc;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        .schedule-item {
            background: #333;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-left: 3px solid #FF0000;
        }

        .schedule-toggle {
            background: none;
            border: none;
            color: #FF0000;
            font-size: 1.2rem;
        }

        .config-section {
            background: #333;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .progress-container {
            background: #333;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            display: none;
        }

        .verification-result {
            background: #333;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .verification-result.passed {
            border-left: 3px solid #28a745;
        }

        .verification-result.failed {
            border-left: 3px solid #dc3545;
        }

        .verification-result.warning {
            border-left: 3px solid #ffc107;
        }

        .feature-badge {
            background: linear-gradient(45deg, #FF0000, #CC0000);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .backup-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .backup-actions .btn {
            flex: 1;
            min-width: 120px;
        }

        .storage-usage {
            background: #333;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .usage-bar {
            background: #555;
            border-radius: 4px;
            height: 8px;
            overflow: hidden;
        }

        .usage-fill {
            background: linear-gradient(90deg, #28a745, #ffc107, #dc3545);
            height: 100%;
            transition: width 0.3s ease;
        }

        .test-result {
            background: #333;
            border-radius: 6px;
            padding: 0.75rem;
            margin: 0.5rem 0;
            border-left: 3px solid #ccc;
        }

        .test-result.passed { border-left-color: #28a745; }
        .test-result.failed { border-left-color: #dc3545; }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12">
                <h1 class="text-white mb-2">
                    <i class="fas fa-shield-alt text-danger me-2"></i>
                    Backup Management
                    <span class="feature-badge">Phase 5.3.8 Complete</span>
                </h1>
                <p class="text-muted">System backup and disaster recovery management</p>
            </div>
        </div>

        <!-- System Status -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="backup-card">
                    <h4 class="text-white mb-3">
                        <i class="fas fa-heartbeat text-danger me-2"></i>
                        System Status
                    </h4>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="system-status">
                                <div class="d-flex align-items-center">
                                    <span class="status-indicator healthy" id="backup-system-status"></span>
                                    <span class="text-white">Backup System</span>
                                </div>
                                <div class="text-muted small mt-1" id="backup-system-message">All systems operational</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="system-status">
                                <div class="d-flex align-items-center">
                                    <span class="status-indicator healthy" id="storage-status"></span>
                                    <span class="text-white">Storage</span>
                                </div>
                                <div class="text-muted small mt-1" id="storage-message">Sufficient space available</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="system-status">
                                <div class="d-flex align-items-center">
                                    <span class="status-indicator healthy" id="database-status"></span>
                                    <span class="text-white">Database</span>
                                </div>
                                <div class="text-muted small mt-1" id="database-message">Connection healthy</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="system-status">
                                <div class="d-flex align-items-center">
                                    <span class="status-indicator warning" id="s3-status"></span>
                                    <span class="text-white">Remote Storage</span>
                                </div>
                                <div class="text-muted small mt-1" id="s3-message">Not configured</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="row mb-4">
            <div class="col-12">
                <ul class="nav nav-tabs nav-fill" id="backupTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab">
                            <i class="fas fa-tachometer-alt me-2"></i>Overview
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="backups-tab" data-bs-toggle="tab" data-bs-target="#backups" type="button" role="tab">
                            <i class="fas fa-archive me-2"></i>Backups
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="schedules-tab" data-bs-toggle="tab" data-bs-target="#schedules" type="button" role="tab">
                            <i class="fas fa-clock me-2"></i>Schedules
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings" type="button" role="tab">
                            <i class="fas fa-cog me-2"></i>Settings
                        </button>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Tab Content -->
        <div class="tab-content" id="backupTabContent">
            <!-- Overview Tab -->
            <div class="tab-pane fade show active" id="overview" role="tabpanel">
                <div class="row">
                    <!-- Statistics -->
                    <div class="col-lg-8">
                        <div class="backup-card">
                            <h5 class="text-white mb-3">
                                <i class="fas fa-chart-bar text-danger me-2"></i>
                                Backup Statistics
                            </h5>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="metric-card">
                                        <div class="metric-value" id="total-backups">0</div>
                                        <div class="metric-label">Total Backups</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric-card">
                                        <div class="metric-value" id="total-size">0 GB</div>
                                        <div class="metric-label">Total Size</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric-card">
                                        <div class="metric-value" id="success-rate">100%</div>
                                        <div class="metric-label">Success Rate</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric-card">
                                        <div class="metric-value" id="last-backup">Never</div>
                                        <div class="metric-label">Last Backup</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Storage Usage -->
                        <div class="backup-card">
                            <h5 class="text-white mb-3">
                                <i class="fas fa-hdd text-danger me-2"></i>
                                Storage Usage
                            </h5>
                            <div class="storage-usage">
                                <div class="d-flex justify-content-between mb-2">
                                    <span class="text-white">Backup Storage</span>
                                    <span class="text-muted" id="storage-usage-text">0 GB / 100 GB</span>
                                </div>
                                <div class="usage-bar">
                                    <div class="usage-fill" id="storage-usage-bar" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="storage-usage">
                                <div class="d-flex justify-content-between mb-2">
                                    <span class="text-white">System Disk</span>
                                    <span class="text-muted" id="disk-usage-text">0 GB / 500 GB</span>
                                </div>
                                <div class="usage-bar">
                                    <div class="usage-fill" id="disk-usage-bar" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="col-lg-4">
                        <div class="backup-card">
                            <h5 class="text-white mb-3">
                                <i class="fas fa-bolt text-danger me-2"></i>
                                Quick Actions
                            </h5>
                            <div class="d-grid gap-2">
                                <button class="btn btn-danger" id="create-backup-btn">
                                    <i class="fas fa-plus me-2"></i>Create Backup Now
                                </button>
                                <button class="btn btn-outline-light" id="test-system-btn">
                                    <i class="fas fa-stethoscope me-2"></i>Test System
                                </button>
                                <button class="btn btn-outline-light" id="verify-latest-btn">
                                    <i class="fas fa-check-circle me-2"></i>Verify Latest Backup
                                </button>
                                <button class="btn btn-outline-light" id="cleanup-old-btn">
                                    <i class="fas fa-trash me-2"></i>Cleanup Old Backups
                                </button>
                            </div>
                        </div>

                        <!-- Recent Activity -->
                        <div class="backup-card">
                            <h5 class="text-white mb-3">
                                <i class="fas fa-history text-danger me-2"></i>
                                Recent Activity
                            </h5>
                            <div id="recent-activity">
                                <!-- Activity items will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Backups Tab -->
            <div class="tab-pane fade" id="backups" role="tabpanel">
                <div class="backup-card">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h4 class="text-white mb-0">
                            <i class="fas fa-archive text-danger me-2"></i>
                            System Backups
                        </h4>
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-light" id="refresh-backups-btn">
                                <i class="fas fa-sync-alt me-1"></i> Refresh
                            </button>
                            <button class="btn btn-danger" id="create-manual-backup-btn">
                                <i class="fas fa-plus me-1"></i> Create Backup
                            </button>
                        </div>
                    </div>
                    
                    <!-- Backup Filters -->
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <select class="form-select bg-dark border-secondary text-white" id="backup-type-filter">
                                <option value="all">All Types</option>
                                <option value="system">System Backups</option>
                                <option value="database">Database Only</option>
                                <option value="files">Files Only</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select bg-dark border-secondary text-white" id="backup-status-filter">
                                <option value="all">All Status</option>
                                <option value="completed">Completed</option>
                                <option value="failed">Failed</option>
                                <option value="running">Running</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select bg-dark border-secondary text-white" id="backup-location-filter">
                                <option value="all">All Locations</option>
                                <option value="local">Local Only</option>
                                <option value="remote">Remote Only</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <input type="text" class="form-control bg-dark border-secondary text-white" 
                                   id="backup-search" placeholder="Search backups...">
                        </div>
                    </div>
                    
                    <!-- Backup List -->
                    <div id="backup-list">
                        <!-- Backup items will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Schedules Tab -->
            <div class="tab-pane fade" id="schedules" role="tabpanel">
                <div class="row">
                    <div class="col-lg-8">
                        <div class="backup-card">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h4 class="text-white mb-0">
                                    <i class="fas fa-clock text-danger me-2"></i>
                                    Backup Schedules
                                </h4>
                                <button class="btn btn-danger" id="add-schedule-btn">
                                    <i class="fas fa-plus me-1"></i> Add Schedule
                                </button>
                            </div>
                            
                            <div id="schedule-list">
                                <!-- Schedule items will be loaded here -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-4">
                        <div class="backup-card">
                            <h5 class="text-white mb-3">
                                <i class="fas fa-info-circle text-danger me-2"></i>
                                Schedule Information
                            </h5>
                            <div class="text-muted">
                                <p><strong>Schedule Types:</strong></p>
                                <ul>
                                    <li><strong>Full:</strong> Complete system backup</li>
                                    <li><strong>Database:</strong> Database only</li>
                                    <li><strong>Files:</strong> Files and uploads only</li>
                                </ul>
                                
                                <p class="mt-3"><strong>Frequencies:</strong></p>
                                <ul>
                                    <li><strong>Daily:</strong> Every day at specified time</li>
                                    <li><strong>Weekly:</strong> Once per week</li>
                                    <li><strong>Monthly:</strong> Once per month</li>
                                </ul>
                                
                                <div class="alert alert-warning mt-3">
                                    <i class="fas fa-exclamation-triangle me-2"></i>
                                    <strong>Note:</strong> Scheduled backups require system cron to be configured.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-pane fade" id="settings" role="tabpanel">
                <div class="row">
                    <div class="col-lg-8">
                        <div class="backup-card">
                            <h4 class="text-white mb-3">
                                <i class="fas fa-cog text-danger me-2"></i>
                                Backup Configuration
                            </h4>
                            
                            <!-- General Settings -->
                            <div class="config-section">
                                <h6 class="text-white mb-3">General Settings</h6>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label text-white">Retention Period (days)</label>
                                            <input type="number" class="form-control bg-dark border-secondary text-white" 
                                                   id="retention-days" value="30" min="1" max="365">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label text-white">Compression Level</label>
                                            <select class="form-select bg-dark border-secondary text-white" id="compression-level">
                                                <option value="1">1 - Fastest</option>
                                                <option value="6" selected>6 - Balanced</option>
                                                <option value="9">9 - Best Compression</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="auto-backup-enabled">
                                            <label class="form-check-label text-white" for="auto-backup-enabled">
                                                Enable automatic backups
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="compression-enabled" checked>
                                            <label class="form-check-label text-white" for="compression-enabled">
                                                Enable compression
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="verify-backups" checked>
                                            <label class="form-check-label text-white" for="verify-backups">
                                                Verify backup integrity
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="cleanup-old-backups" checked>
                                            <label class="form-check-label text-white" for="cleanup-old-backups">
                                                Auto-cleanup old backups
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- S3 Settings -->
                            <div class="config-section">
                                <h6 class="text-white mb-3">Remote Storage (S3)</h6>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="s3-enabled">
                                    <label class="form-check-label text-white" for="s3-enabled">
                                        Enable S3 remote storage
                                    </label>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label text-white">S3 Bucket Name</label>
                                            <input type="text" class="form-control bg-dark border-secondary text-white" 
                                                   id="s3-bucket" placeholder="interviews-tv-backups">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label text-white">AWS Region</label>
                                            <select class="form-select bg-dark border-secondary text-white" id="s3-region">
                                                <option value="us-east-1">US East (N. Virginia)</option>
                                                <option value="us-west-2">US West (Oregon)</option>
                                                <option value="eu-west-1">Europe (Ireland)</option>
                                                <option value="ap-southeast-1">Asia Pacific (Singapore)</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Notification Settings -->
                            <div class="config-section">
                                <h6 class="text-white mb-3">Notifications</h6>
                                <div class="mb-3">
                                    <label class="form-label text-white">Notification Email</label>
                                    <input type="email" class="form-control bg-dark border-secondary text-white" 
                                           id="notification-email" placeholder="admin@interviews.tv">
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="notify-success" checked>
                                            <label class="form-check-label text-white" for="notify-success">
                                                Notify on successful backups
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="notify-failure" checked>
                                            <label class="form-check-label text-white" for="notify-failure">
                                                Notify on backup failures
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="text-center">
                                <button class="btn btn-danger btn-lg" id="save-config-btn">
                                    <i class="fas fa-save me-2"></i>Save Configuration
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-4">
                        <div class="backup-card">
                            <h5 class="text-white mb-3">
                                <i class="fas fa-tools text-danger me-2"></i>
                                System Tests
                            </h5>
                            <div class="d-grid gap-2 mb-3">
                                <button class="btn btn-outline-light" id="test-backup-system-btn">
                                    <i class="fas fa-stethoscope me-2"></i>Test Backup System
                                </button>
                                <button class="btn btn-outline-light" id="test-database-btn">
                                    <i class="fas fa-database me-2"></i>Test Database Connection
                                </button>
                                <button class="btn btn-outline-light" id="test-s3-btn">
                                    <i class="fas fa-cloud me-2"></i>Test S3 Connection
                                </button>
                            </div>
                            
                            <div id="test-results">
                                <!-- Test results will be displayed here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Progress Modal -->
        <div class="progress-container" id="backup-progress">
            <h6 class="text-white mb-2">Creating Backup...</h6>
            <div class="progress mb-2">
                <div class="progress-bar bg-danger" role="progressbar" style="width: 0%"></div>
            </div>
            <div class="text-muted small" id="backup-status">Preparing backup...</div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/backup-management.js"></script>
</body>
</html>
