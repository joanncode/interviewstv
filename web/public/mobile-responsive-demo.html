<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <title>Mobile Responsive Chat - Interviews.tv</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom Dark Theme CSS -->
    <style>
        :root {
            --primary-color: #FF0000;
            --bg-dark: #1a1a1a;
            --card-dark: #2a2a2a;
            --input-dark: #3a3a3a;
            --text-light: #ffffff;
            --text-muted: #cccccc;
            --border-color: #444444;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-light);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
        }

        .navbar {
            background-color: var(--card-dark) !important;
            border-bottom: 2px solid var(--primary-color);
            flex-shrink: 0;
        }

        .navbar-brand {
            color: var(--primary-color) !important;
            font-weight: bold;
            font-size: 1.5rem;
        }

        .navbar-nav .nav-link {
            color: var(--text-light) !important;
        }

        .navbar-nav .nav-link:hover {
            color: var(--primary-color) !important;
        }

        .main-container {
            display: flex;
            height: calc(100vh - 76px);
        }

        .demo-sidebar {
            width: 350px;
            background: var(--card-dark);
            border-right: 1px solid var(--border-color);
            padding: 1.5rem;
            overflow-y: auto;
            flex-shrink: 0;
        }

        .demo-section {
            margin-bottom: 2rem;
        }

        .demo-section h5 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .demo-controls {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .status-indicator.connected {
            background-color: rgba(40, 167, 69, 0.2);
            color: #28a745;
            border: 1px solid #28a745;
        }

        .status-indicator.disconnected {
            background-color: rgba(220, 53, 69, 0.2);
            color: #dc3545;
            border: 1px solid #dc3545;
        }

        .demo-control {
            background: var(--input-dark);
            border: 1px solid var(--border-color);
            color: var(--text-light);
            border-radius: 6px;
            padding: 0.5rem 0.75rem;
            font-size: 0.9rem;
        }

        .demo-control:focus {
            outline: none;
            border-color: var(--primary-color);
            color: var(--text-light);
        }

        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .btn-primary:hover {
            background-color: #cc0000;
            border-color: #cc0000;
        }

        .btn-secondary {
            background-color: var(--input-dark);
            border-color: var(--border-color);
            color: var(--text-light);
        }

        .btn-secondary:hover {
            background-color: #4a4a4a;
            border-color: #555;
            color: var(--text-light);
        }

        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 0;
            position: relative;
        }

        .demo-info {
            background: rgba(23, 162, 184, 0.1);
            border: 1px solid #17a2b8;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .demo-info h6 {
            color: #17a2b8;
            margin-bottom: 0.5rem;
        }

        .demo-info p {
            color: var(--text-muted);
            margin-bottom: 0;
            font-size: 0.9rem;
        }

        .feature-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .feature-list li {
            padding: 0.25rem 0;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .feature-list li i {
            color: var(--primary-color);
            width: 16px;
            margin-right: 0.5rem;
        }

        .mobile-demo-controls {
            background: var(--input-dark);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .mobile-demo-controls h6 {
            color: var(--text-light);
            margin-bottom: 0.75rem;
        }

        .simulation-btn {
            background: var(--card-dark);
            border: 1px solid var(--border-color);
            color: var(--text-light);
            padding: 0.4rem 0.8rem;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
            margin: 0.25rem;
        }

        .simulation-btn:hover {
            background: var(--primary-color);
            border-color: var(--primary-color);
        }

        .simulation-btn.mobile { border-color: #6f42c1; }
        .simulation-btn.tablet { border-color: #17a2b8; }
        .simulation-btn.desktop { border-color: #28a745; }
        .simulation-btn.touch { border-color: #ffc107; }
        .simulation-btn.orientation { border-color: #fd7e14; }

        .device-preview {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid var(--primary-color);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .device-preview h6 {
            color: var(--primary-color);
            margin-bottom: 0.75rem;
        }

        .device-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.25rem 0;
            font-size: 0.9rem;
        }

        .device-label {
            color: var(--text-muted);
        }

        .device-value {
            font-weight: 600;
            color: var(--text-light);
        }

        .viewport-simulator {
            background: var(--card-dark);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .viewport-simulator h6 {
            color: var(--text-light);
            margin-bottom: 0.75rem;
        }

        .viewport-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .viewport-preset {
            background: var(--input-dark);
            border: 1px solid var(--border-color);
            color: var(--text-light);
            padding: 0.5rem;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .viewport-preset:hover,
        .viewport-preset.active {
            background: var(--primary-color);
            border-color: var(--primary-color);
        }

        .touch-feedback {
            background: rgba(255, 0, 0, 0.3) !important;
            transform: scale(0.95);
            transition: all 0.1s ease;
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .demo-sidebar {
                width: 100%;
                height: auto;
                max-height: 300px;
                padding: 1rem;
            }
            
            .demo-controls {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .viewport-controls {
                grid-template-columns: 1fr;
            }
        }

        /* Mobile responsive demo styles */
        .mobile-responsive-demo {
            position: relative;
        }

        .mobile-responsive-demo.mobile-simulation {
            max-width: 375px;
            margin: 0 auto;
            border: 2px solid var(--border-color);
            border-radius: 20px;
            overflow: hidden;
        }

        .mobile-responsive-demo.tablet-simulation {
            max-width: 768px;
            margin: 0 auto;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
        }

        .orientation-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            z-index: 1001;
            display: none;
        }

        .orientation-indicator.visible {
            display: block;
        }

        /* Touch active feedback */
        .touch-active {
            background: rgba(255, 0, 0, 0.2) !important;
            transform: scale(0.98);
        }

        /* Highlight animation for mobile features */
        .highlighted {
            background: rgba(255, 0, 0, 0.2) !important;
            border: 1px solid var(--primary-color) !important;
            animation: highlight-pulse 2s ease-in-out;
        }

        @keyframes highlight-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fas fa-video me-2"></i>Interviews.tv
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="interview-room.html">
                            <i class="fas fa-comments me-1"></i>Basic Chat
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="modern-chat-demo.html">
                            <i class="fas fa-sparkles me-1"></i>Modern Chat
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="chat-customization-demo.html">
                            <i class="fas fa-palette me-1"></i>Customization
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="mobile-responsive-demo.html">
                            <i class="fas fa-mobile-alt me-1"></i>Mobile Responsive
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Orientation Indicator -->
    <div class="orientation-indicator" id="orientation-indicator">
        <i class="fas fa-mobile-alt me-2"></i>
        <span id="orientation-text">Portrait</span>
    </div>

    <div class="main-container">
        <!-- Demo Sidebar -->
        <div class="demo-sidebar">
            <!-- Connection Status -->
            <div class="demo-section">
                <h5><i class="fas fa-wifi me-2"></i>Connection</h5>
                <div class="demo-controls">
                    <div class="status-indicator disconnected" id="connection-status">
                        <i class="fas fa-circle"></i>
                        <span>Disconnected</span>
                    </div>
                    <button class="btn btn-primary" id="connect-btn">
                        <i class="fas fa-plug me-2"></i>Connect
                    </button>
                </div>
            </div>

            <!-- Device Information -->
            <div class="device-preview">
                <h6><i class="fas fa-mobile-alt me-2"></i>Device Information</h6>
                <div class="device-info">
                    <span class="device-label">Type:</span>
                    <span class="device-value" id="device-type">Desktop</span>
                </div>
                <div class="device-info">
                    <span class="device-label">Viewport:</span>
                    <span class="device-value" id="viewport-size">1920x1080</span>
                </div>
                <div class="device-info">
                    <span class="device-label">Orientation:</span>
                    <span class="device-value" id="orientation-status">Landscape</span>
                </div>
                <div class="device-info">
                    <span class="device-label">Touch:</span>
                    <span class="device-value" id="touch-support">No</span>
                </div>
                <div class="device-info">
                    <span class="device-label">Pixel Ratio:</span>
                    <span class="device-value" id="pixel-ratio">1</span>
                </div>
            </div>

            <!-- Viewport Simulator -->
            <div class="viewport-simulator">
                <h6><i class="fas fa-desktop me-2"></i>Viewport Simulator</h6>
                <div class="viewport-controls">
                    <button class="viewport-preset" data-width="375" data-height="667">iPhone SE</button>
                    <button class="viewport-preset" data-width="390" data-height="844">iPhone 12</button>
                    <button class="viewport-preset" data-width="414" data-height="896">iPhone 11</button>
                    <button class="viewport-preset" data-width="360" data-height="640">Android</button>
                    <button class="viewport-preset" data-width="768" data-height="1024">iPad</button>
                    <button class="viewport-preset" data-width="1024" data-height="768">iPad Landscape</button>
                    <button class="viewport-preset" data-width="1920" data-height="1080">Desktop</button>
                    <button class="viewport-preset" data-width="2560" data-height="1440">Large Desktop</button>
                </div>
            </div>

            <!-- Mobile Features -->
            <div class="demo-section">
                <h5><i class="fas fa-mobile-alt me-2"></i>Mobile Features</h5>
                <ul class="feature-list">
                    <li><i class="fas fa-check"></i>Touch gesture support</li>
                    <li><i class="fas fa-check"></i>Swipe navigation</li>
                    <li><i class="fas fa-check"></i>Mobile header & toolbar</li>
                    <li><i class="fas fa-check"></i>Virtual keyboard handling</li>
                    <li><i class="fas fa-check"></i>Orientation detection</li>
                    <li><i class="fas fa-check"></i>Responsive breakpoints</li>
                    <li><i class="fas fa-check"></i>Touch-optimized targets</li>
                    <li><i class="fas fa-check"></i>Haptic feedback</li>
                    <li><i class="fas fa-check"></i>Pull-to-refresh</li>
                    <li><i class="fas fa-check"></i>Safe area handling</li>
                    <li><i class="fas fa-check"></i>Performance optimization</li>
                    <li><i class="fas fa-check"></i>Accessibility features</li>
                </ul>
            </div>

            <!-- Mobile Demo Controls -->
            <div class="mobile-demo-controls">
                <h6><i class="fas fa-robot me-2"></i>Mobile Testing</h6>
                <button class="simulation-btn mobile" onclick="simulateDevice('mobile')">
                    <i class="fas fa-mobile-alt me-1"></i>Mobile View
                </button>
                <button class="simulation-btn tablet" onclick="simulateDevice('tablet')">
                    <i class="fas fa-tablet-alt me-1"></i>Tablet View
                </button>
                <button class="simulation-btn desktop" onclick="simulateDevice('desktop')">
                    <i class="fas fa-desktop me-1"></i>Desktop View
                </button>
                <button class="simulation-btn touch" onclick="toggleTouchMode()">
                    <i class="fas fa-hand-pointer me-1"></i>Touch Mode
                </button>
                <button class="simulation-btn orientation" onclick="toggleOrientation()">
                    <i class="fas fa-sync-alt me-1"></i>Rotate Device
                </button>
                
                <div style="margin-top: 0.75rem;">
                    <button class="simulation-btn" onclick="addSampleMessages()">
                        <i class="fas fa-plus me-1"></i>Add Messages
                    </button>
                    <button class="simulation-btn" onclick="testSwipeGestures()">
                        <i class="fas fa-hand-paper me-1"></i>Test Swipes
                    </button>
                    <button class="simulation-btn" onclick="testKeyboardHandling()">
                        <i class="fas fa-keyboard me-1"></i>Test Keyboard
                    </button>
                    <button class="simulation-btn" onclick="updateDeviceInfo()">
                        <i class="fas fa-sync me-1"></i>Update Info
                    </button>
                </div>
            </div>
        </div>

        <!-- Chat Container -->
        <div class="chat-container">
            <!-- Demo Info -->
            <div class="demo-info">
                <h6><i class="fas fa-info-circle me-2"></i>Mobile Responsive Chat Interface</h6>
                <p>Experience comprehensive mobile optimization with touch gestures, responsive design, virtual keyboard handling, and device-specific adaptations. Test different viewport sizes and orientations to see the interface adapt in real-time.</p>
            </div>

            <!-- Chat Interface -->
            <div id="modern-chat-container" class="mobile-responsive-demo" style="flex: 1;"></div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Chat Components -->
    <script src="../src/components/EmojiInterface.js"></script>
    <script src="../src/components/ChatModerationInterface.js"></script>
    <script src="../src/components/ChatCommandInterface.js"></script>
    <script src="../src/components/PrivateMessageInterface.js"></script>
    <script src="../src/components/ChatExportInterface.js"></script>
    <script src="../src/components/MessageThreadingInterface.js"></script>
    <script src="../src/components/TypingIndicatorInterface.js"></script>
    <script src="../src/components/UserListInterface.js"></script>
    <script src="../src/components/ChatNotificationInterface.js"></script>
    <script src="../src/components/ChatSearchInterface.js"></script>
    <script src="../src/components/ChatCustomizationInterface.js"></script>
    <script src="../src/components/MobileResponsiveInterface.js"></script>
    <script src="../src/components/ModernChatInterface.js"></script>
    
    <!-- Demo Script -->
    <script>
        let websocket = null;
        let modernChatInterface = null;
        let mobileInterface = null;
        let currentUserRole = 'admin';
        let currentUserName = 'Demo User';
        let currentRoomId = 'demo_room';
        let touchModeEnabled = false;
        let currentSimulation = 'desktop';
        
        // Mock data for simulation
        const mockUserNames = [
            'Alice Johnson', 'Bob Smith', 'Carol Davis', 'David Wilson', 'Emma Brown',
            'Frank Miller', 'Grace Lee', 'Henry Taylor', 'Ivy Chen', 'Jack Anderson'
        ];
        
        const sampleMessages = [
            "Welcome to the mobile-responsive chat interface!",
            "This interface adapts to different screen sizes and devices.",
            "Try resizing your browser or using the viewport simulator.",
            "Touch gestures are supported on mobile devices.",
            "Swipe left or right to access different panels.",
            "The interface handles virtual keyboards automatically.",
            "Orientation changes are detected and handled smoothly.",
            "Touch targets are optimized for finger interaction.",
            "The mobile header provides quick access to features.",
            "Mobile toolbar offers convenient action buttons.",
            "Pull-to-refresh functionality is available.",
            "Safe area insets are handled for notched devices.",
            "Performance is optimized for mobile devices.",
            "Accessibility features ensure inclusive design.",
            "The interface works great on tablets too!",
            "Desktop users get the full feature set.",
            "Responsive breakpoints ensure optimal layout.",
            "Touch feedback provides visual confirmation.",
            "Long press actions reveal context menus.",
            "Enjoy the seamless mobile experience!"
        ];
        
        // Initialize demo
        document.addEventListener('DOMContentLoaded', function() {
            initializeDemo();
            attachEventListeners();
            updateDeviceInfo();
        });
        
        function initializeDemo() {
            // Initialize modern chat interface with mobile responsiveness
            const container = document.getElementById('modern-chat-container');
            
            if (typeof ModernChatInterface !== 'undefined') {
                modernChatInterface = new ModernChatInterface({
                    container: container,
                    websocket: websocket,
                    currentUserId: 'demo_user',
                    currentUserRole: currentUserRole,
                    roomId: currentRoomId,
                    settings: {
                        theme: 'dark',
                        colorScheme: 'red',
                        fontSize: 'medium',
                        mobileLayout: 'adaptive',
                        touchOptimized: true,
                        swipeGestures: true,
                        virtualKeyboardHandling: true,
                        largerTouchTargets: true,
                        reducedAnimations: false,
                        compactMode: false,
                        autoScroll: true,
                        animations: true
                    }
                });
                
                // Set global reference
                window.modernChat = modernChatInterface;
                
                // Get mobile interface reference
                mobileInterface = modernChatInterface.mobileInterface;
                window.mobileResponsive = mobileInterface;
                
                // Update device info initially
                setTimeout(() => {
                    updateDeviceInfo();
                }, 1000);
            }
        }
        
        function attachEventListeners() {
            // Connect button
            document.getElementById('connect-btn')?.addEventListener('click', toggleConnection);
            
            // Viewport presets
            document.querySelectorAll('.viewport-preset').forEach(preset => {
                preset.addEventListener('click', (e) => {
                    const width = parseInt(e.target.dataset.width);
                    const height = parseInt(e.target.dataset.height);
                    simulateViewport(width, height);
                    
                    // Update active state
                    document.querySelectorAll('.viewport-preset').forEach(p => p.classList.remove('active'));
                    e.target.classList.add('active');
                });
            });
            
            // Orientation change detection
            window.addEventListener('orientationchange', () => {
                setTimeout(updateDeviceInfo, 100);
                showOrientationIndicator();
            });
            
            // Resize detection
            window.addEventListener('resize', () => {
                updateDeviceInfo();
            });
        }
        
        function toggleConnection() {
            if (websocket && websocket.readyState === WebSocket.OPEN) {
                disconnectWebSocket();
            } else {
                connectWebSocket();
            }
        }
        
        function connectWebSocket() {
            try {
                // Simulate WebSocket connection
                websocket = {
                    readyState: WebSocket.OPEN,
                    send: function(data) {
                        console.log('Sending:', JSON.parse(data));
                        // Simulate server responses
                        setTimeout(() => {
                            const message = JSON.parse(data);
                            handleMockResponse(message);
                        }, 100);
                    },
                    addEventListener: function(event, handler) {
                        this[event] = handler;
                    },
                    close: function() {
                        this.readyState = WebSocket.CLOSED;
                        if (this.onclose) this.onclose();
                    }
                };
                
                console.log('Mock WebSocket connected');
                updateConnectionStatus(true);
                
                // Update chat interface
                if (modernChatInterface) {
                    modernChatInterface.setWebSocket(websocket);
                }
                
                // Add some initial messages
                setTimeout(() => {
                    addSampleMessages();
                }, 1000);
                
            } catch (error) {
                console.error('Failed to connect WebSocket:', error);
                updateConnectionStatus(false);
            }
        }
        
        function disconnectWebSocket() {
            if (websocket) {
                websocket.close();
                websocket = null;
            }
            updateConnectionStatus(false);
        }
        
        function updateConnectionStatus(connected) {
            const statusElement = document.getElementById('connection-status');
            const connectBtn = document.getElementById('connect-btn');
            
            if (statusElement) {
                if (connected) {
                    statusElement.className = 'status-indicator connected';
                    statusElement.innerHTML = '<i class="fas fa-circle"></i><span>Connected</span>';
                } else {
                    statusElement.className = 'status-indicator disconnected';
                    statusElement.innerHTML = '<i class="fas fa-circle"></i><span>Disconnected</span>';
                }
            }
            
            if (connectBtn) {
                if (connected) {
                    connectBtn.innerHTML = '<i class="fas fa-unlink me-2"></i>Disconnect';
                    connectBtn.className = 'btn btn-secondary';
                } else {
                    connectBtn.innerHTML = '<i class="fas fa-plug me-2"></i>Connect';
                    connectBtn.className = 'btn btn-primary';
                }
            }
        }
        
        function handleMockResponse(message) {
            if (!websocket || !websocket.message) return;
            
            switch (message.type) {
                case 'chat_message':
                    // Echo the message back
                    websocket.message({
                        data: JSON.stringify({
                            type: 'chat_message',
                            id: 'msg_' + Date.now(),
                            message: message.message,
                            user_id: 'demo_user',
                            user_name: currentUserName,
                            user_role: currentUserRole,
                            timestamp: Date.now(),
                            room_id: message.room_id
                        })
                    });
                    break;
            }
        }
        
        // Mobile testing functions
        function simulateDevice(deviceType) {
            currentSimulation = deviceType;
            const container = document.getElementById('modern-chat-container');
            
            // Remove existing simulation classes
            container.classList.remove('mobile-simulation', 'tablet-simulation');
            
            switch (deviceType) {
                case 'mobile':
                    container.classList.add('mobile-simulation');
                    simulateViewport(375, 667);
                    break;
                case 'tablet':
                    container.classList.add('tablet-simulation');
                    simulateViewport(768, 1024);
                    break;
                case 'desktop':
                    simulateViewport(1920, 1080);
                    break;
            }
            
            updateDeviceInfo();
        }
        
        function simulateViewport(width, height) {
            // This is a visual simulation - in a real app you'd use browser dev tools
            const container = document.getElementById('modern-chat-container');
            
            if (width <= 480) {
                container.style.maxWidth = width + 'px';
                container.style.height = height + 'px';
            } else if (width <= 768) {
                container.style.maxWidth = width + 'px';
                container.style.height = 'auto';
            } else {
                container.style.maxWidth = 'none';
                container.style.height = 'auto';
            }
            
            // Trigger resize event
            window.dispatchEvent(new Event('resize'));
        }
        
        function toggleTouchMode() {
            touchModeEnabled = !touchModeEnabled;
            const container = document.getElementById('modern-chat-container');
            
            if (touchModeEnabled) {
                container.classList.add('touch-device');
                // Simulate touch events
                addTouchEventListeners();
            } else {
                container.classList.remove('touch-device');
                removeTouchEventListeners();
            }
            
            updateDeviceInfo();
        }
        
        function toggleOrientation() {
            // Simulate orientation change
            const container = document.getElementById('modern-chat-container');
            const isLandscape = container.classList.contains('landscape-mode');
            
            container.classList.remove('landscape-mode', 'portrait-mode');
            container.classList.add(isLandscape ? 'portrait-mode' : 'landscape-mode');
            
            // Trigger orientation change event
            if (mobileInterface) {
                mobileInterface.handleOrientationChange(!isLandscape);
            }
            
            showOrientationIndicator();
            updateDeviceInfo();
        }
        
        function addTouchEventListeners() {
            const container = document.getElementById('modern-chat-container');
            
            container.addEventListener('touchstart', handleTouchFeedback);
            container.addEventListener('touchend', removeTouchFeedback);
        }
        
        function removeTouchEventListeners() {
            const container = document.getElementById('modern-chat-container');
            
            container.removeEventListener('touchstart', handleTouchFeedback);
            container.removeEventListener('touchend', removeTouchFeedback);
        }
        
        function handleTouchFeedback(event) {
            const target = event.target.closest('.message-item, .user-item, button');
            if (target) {
                target.classList.add('touch-feedback');
            }
        }
        
        function removeTouchFeedback(event) {
            const target = event.target.closest('.message-item, .user-item, button');
            if (target) {
                setTimeout(() => {
                    target.classList.remove('touch-feedback');
                }, 150);
            }
        }
        
        function testSwipeGestures() {
            if (mobileInterface) {
                // Simulate swipe gestures
                console.log('Testing swipe gestures...');
                
                // Simulate swipe left
                setTimeout(() => {
                    mobileInterface.handleSwipe('left', { target: document.body });
                }, 500);
                
                // Simulate swipe right
                setTimeout(() => {
                    mobileInterface.handleSwipe('right', { target: document.body });
                }, 1500);
                
                // Simulate swipe up
                setTimeout(() => {
                    mobileInterface.handleSwipe('up', { target: document.body });
                }, 2500);
            }
        }
        
        function testKeyboardHandling() {
            // Simulate virtual keyboard
            const container = document.getElementById('modern-chat-container');
            
            if (container.classList.contains('keyboard-visible')) {
                container.classList.remove('keyboard-visible');
                container.style.paddingBottom = '';
            } else {
                container.classList.add('keyboard-visible');
                container.style.paddingBottom = '300px'; // Simulate keyboard height
            }
        }
        
        function addSampleMessages() {
            if (!websocket || !websocket.message) return;
            
            sampleMessages.forEach((msg, index) => {
                setTimeout(() => {
                    const userName = mockUserNames[index % mockUserNames.length];
                    const userRole = index % 4 === 0 ? 'admin' : index % 3 === 0 ? 'moderator' : 'participant';
                    
                    websocket.message({
                        data: JSON.stringify({
                            type: 'chat_message',
                            id: 'sample_' + Date.now() + '_' + index,
                            message: msg,
                            user_id: 'user_' + (index % mockUserNames.length),
                            user_name: userName,
                            user_role: userRole,
                            timestamp: Date.now() - (sampleMessages.length - index) * 30000,
                            room_id: currentRoomId
                        })
                    });
                }, index * 150);
            });
        }
        
        function updateDeviceInfo() {
            const deviceInfo = mobileInterface ? mobileInterface.getDeviceInfo() : {
                isMobile: window.innerWidth <= 480,
                isTablet: window.innerWidth > 480 && window.innerWidth <= 768,
                isLandscape: window.innerWidth > window.innerHeight,
                touchSupported: 'ontouchstart' in window,
                devicePixelRatio: window.devicePixelRatio || 1,
                viewport: { width: window.innerWidth, height: window.innerHeight }
            };
            
            // Update device type
            let deviceType = 'Desktop';
            if (deviceInfo.isMobile) deviceType = 'Mobile';
            else if (deviceInfo.isTablet) deviceType = 'Tablet';
            
            document.getElementById('device-type').textContent = deviceType;
            document.getElementById('viewport-size').textContent = 
                `${deviceInfo.viewport.width}x${deviceInfo.viewport.height}`;
            document.getElementById('orientation-status').textContent = 
                deviceInfo.isLandscape ? 'Landscape' : 'Portrait';
            document.getElementById('touch-support').textContent = 
                deviceInfo.touchSupported || touchModeEnabled ? 'Yes' : 'No';
            document.getElementById('pixel-ratio').textContent = 
                deviceInfo.devicePixelRatio.toFixed(1);
        }
        
        function showOrientationIndicator() {
            const indicator = document.getElementById('orientation-indicator');
            const text = document.getElementById('orientation-text');
            
            const isLandscape = window.innerWidth > window.innerHeight;
            text.textContent = isLandscape ? 'Landscape' : 'Portrait';
            
            indicator.classList.add('visible');
            setTimeout(() => {
                indicator.classList.remove('visible');
            }, 2000);
        }
        
        // Auto-connect on page load
        setTimeout(() => {
            connectWebSocket();
        }, 1000);
        
        // Update device info periodically
        setInterval(updateDeviceInfo, 3000);
    </script>
</body>
</html>
